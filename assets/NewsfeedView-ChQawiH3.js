import{A as C,v as H,u as N,_ as S}from"./vi-CDtmk3gP.js";import{_ as j}from"./PostCreate.vue_vue_type_script_setup_true_lang-07GEJaUW.js";import{d as k,c as F,e as a,o as s,f as t,h as i,i as b,j as M,g as p,t as d,F as L,m as B,w as y,b as T,p as x,q as D,s as z,v as q,x as E,y as _,n as V}from"./index-CQSWO8Li.js";import{L as I,f as P,a as w}from"./Loading-Bm1gauNR.js";import"./Button-DeOwv_UT.js";const A={class:"bg-white p-4 transition-colors hover:bg-gray-50"},O={class:"flex gap-3 mb-3"},R={class:"flex-1 min-w-0"},U={class:"flex items-center gap-1 flex-wrap"},G={key:0,viewBox:"0 0 22 22",width:"18",height:"18",fill:"#1d9bf0"},J={class:"text-gray-600 font-normal"},K={class:"text-gray-600 text-sm"},Q={class:"mb-3 pl-0"},W={class:"text-gray-900 leading-6 whitespace-pre-wrap wrap-break-word mb-3"},X={key:0,class:"grid grid-cols-[repeat(auto-fit,minmax(200px,1fr))] gap-2 rounded-2xl overflow-hidden mb-3"},Y=["src","alt"],Z={key:1,class:"border border-gray-300 rounded-2xl p-3 mt-3"},tt={class:"flex items-center gap-2 mb-2"},et={class:"font-bold text-sm text-gray-900"},st={class:"font-normal text-gray-600"},ot={class:"text-gray-900 text-sm leading-snug"},nt={class:"flex justify-between items-center max-w-md mt-2 pl-0"},at=k({__name:"PostCard",props:{post:{}},setup(e){const r=e,l=g=>{try{const n=new Date(g);return P(n,{addSuffix:!0,locale:H})}catch{return g}},c=()=>{console.log("Comment on post:",r.post.id)},o=()=>{console.log("Repost:",r.post.id)},u=()=>{console.log("Share post:",r.post.id)};return(g,n)=>{const f=F("router-link");return s(),a("article",A,[t("div",O,[i(f,{to:`/profile/${e.post.user.username}`,class:"shrink-0"},{default:b(()=>[i(C,{src:e.post.user.avatar_url,name:e.post.user.name,size:"md"},null,8,["src","name"])]),_:1},8,["to"]),t("div",R,[t("div",U,[i(f,{to:`/profile/${e.post.user.username}`,class:"font-bold text-gray-900 flex items-center gap-1 no-underline hover:underline"},{default:b(()=>[M(d(e.post.user.name)+" ",1),e.post.user.verified?(s(),a("svg",G,[...n[0]||(n[0]=[t("path",{d:"M20.396 11c-.018-.646-.215-1.275-.57-1.816-.354-.54-.852-.972-1.438-1.246.223-.607.27-1.264.14-1.897-.131-.634-.437-1.218-.882-1.687-.47-.445-1.053-.75-1.687-.882-.633-.13-1.29-.083-1.897.14-.273-.587-.704-1.086-1.245-1.44S11.647 1.62 11 1.604c-.646.017-1.273.213-1.813.568s-.969.854-1.24 1.44c-.608-.223-1.267-.272-1.902-.14-.635.13-1.22.436-1.69.882-.445.47-.749 1.055-.878 1.688-.13.633-.08 1.29.144 1.896-.587.274-1.087.705-1.443 1.245-.356.54-.555 1.17-.574 1.817.02.647.218 1.276.574 1.817.356.54.856.972 1.443 1.245-.224.606-.274 1.263-.144 1.896.13.634.433 1.218.877 1.688.47.443 1.054.747 1.687.878.633.132 1.29.084 1.897-.136.274.586.705 1.084 1.246 1.439.54.354 1.17.551 1.816.569.647-.016 1.276-.213 1.817-.567s.972-.854 1.245-1.44c.604.239 1.266.296 1.903.164.636-.132 1.22-.447 1.68-.907.46-.46.776-1.044.908-1.681s.075-1.299-.165-1.903c.586-.274 1.084-.705 1.439-1.246.354-.54.551-1.17.569-1.816zM9.662 14.85l-3.429-3.428 1.293-1.302 2.072 2.072 4.4-4.794 1.347 1.246z"},null,-1)])])):p("",!0)]),_:1},8,["to"]),t("span",J,"@"+d(e.post.user.username),1)]),t("span",K,d(l(e.post.created_at)),1)])]),i(f,{to:`/post/${e.post.id}`,class:"no-underline text-inherit block"},{default:b(()=>[t("div",Q,[t("p",W,d(e.post.content),1),e.post.media_urls.length>0?(s(),a("div",X,[(s(!0),a(L,null,B(e.post.media_urls,(v,h)=>(s(),a("img",{key:h,src:v,alt:`Media ${h+1}`,class:"w-full h-full object-cover max-h-96"},null,8,Y))),128))])):p("",!0),e.post.is_quote&&e.post.original_post?(s(),a("div",Z,[t("div",tt,[i(C,{src:e.post.original_post.user.avatar_url,name:e.post.original_post.user.name,size:"sm"},null,8,["src","name"]),t("span",et,[M(d(e.post.original_post.user.name)+" ",1),t("span",st,"@"+d(e.post.original_post.user.username),1)])]),t("p",ot,d(e.post.original_post.content),1)])):p("",!0)])]),_:1},8,["to"]),t("div",nt,[t("button",{class:"flex items-center gap-2 px-2 py-2 border-0 bg-transparent text-gray-600 cursor-pointer rounded-lg transition-all text-sm hover:bg-blue-50 hover:text-blue-500",onClick:y(c,["stop"])},[n[1]||(n[1]=t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor"},[t("path",{d:"M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z"})],-1)),t("span",null,d(e.post.replies_count),1)]),t("button",{class:"flex items-center gap-2 px-2 py-2 border-0 bg-transparent text-gray-600 cursor-pointer rounded-lg transition-all text-sm hover:bg-blue-50 hover:text-blue-500",onClick:y(o,["stop"])},[n[2]||(n[2]=t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor"},[t("path",{d:"M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z"})],-1)),t("span",null,d(e.post.reposts_and_quotes_count),1)]),i(I,{"post-id":e.post.id,"is-liked":e.post.is_liked_by_auth,"likes-count":e.post.likes_count},null,8,["post-id","is-liked","likes-count"]),t("button",{class:"flex items-center gap-2 px-2 py-2 border-0 bg-transparent text-gray-600 cursor-pointer rounded-lg transition-all text-sm hover:bg-blue-50 hover:text-blue-500",onClick:y(u,["stop"])},[...n[3]||(n[3]=[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor"},[t("path",{d:"M12 2.59l5.7 5.7-1.41 1.42L13 6.41V16h-2V6.41l-3.3 3.3-1.41-1.42L12 2.59zM21 15l-.02 3.51c0 1.38-1.12 2.49-2.5 2.49H5.5C4.11 21 3 19.88 3 18.5V15h2v3.5c0 .28.22.5.5.5h12.98c.28 0 .5-.22.5-.5L19 15h2z"})],-1)])])])])}}}),rt={class:"w-full"},lt={key:1,class:"space-y-3 flex flex-col gap-3"},it={key:1,class:"p-4 text-center bg-white rounded-lg shadow-sm"},ct={key:2,class:"p-8 text-center text-gray-600 bg-white rounded-lg shadow-sm"},dt={key:2,class:"flex flex-col items-center justify-center p-16 text-center bg-white shadow-sm rounded-lg"},ut=k({__name:"PostList",props:{feedType:{}},setup(e){const r=e,l=N(),c=T(null),o=x(()=>l.posts),u=x(()=>l.loading),g=x(()=>l.pagination),n=x(()=>g.value?g.value.current_page<g.value.last_page:!1);let f=null;const v=()=>{c.value&&(f=new IntersectionObserver(h=>{h[0].isIntersecting&&n.value&&!u.value&&l.loadMore()},{threshold:.1,rootMargin:"100px"}),f.observe(c.value))};return D(async()=>{await l.fetchFeed(r.feedType||"for_you"),await z(),v()}),q(c,async()=>{await z(),v()}),E(()=>{f&&f.disconnect()}),(h,m)=>(s(),a("div",rt,[u.value&&o.value.length===0?(s(),_(w,{key:0,text:"Đang tải bài đăng..."})):o.value.length>0?(s(),a("div",lt,[(s(!0),a(L,null,B(o.value,$=>(s(),_(at,{key:$.id,post:$,class:"bg-white shadow-sm rounded-lg"},null,8,["post"]))),128)),n.value&&!u.value?(s(),a("div",{key:0,ref_key:"loadMoreTrigger",ref:c,class:"p-4 text-center"},[i(w,{text:"Đang tải thêm..."})],512)):p("",!0),u.value&&o.value.length>0?(s(),a("div",it,[i(w,{text:"Đang tải thêm..."})])):p("",!0),!n.value&&o.value.length>0?(s(),a("div",ct,[...m[0]||(m[0]=[t("p",{class:"m-0 text-sm"},"Bạn đã xem hết bài đăng",-1)])])):p("",!0)])):(s(),a("div",dt,[...m[1]||(m[1]=[t("svg",{viewBox:"0 0 24 24",width:"64",height:"64",fill:"#536471",class:"mb-4"},[t("path",{d:"M12 1.696L.622 8.807l1.06 1.696L3 9.679V19.5C3 20.881 4.119 22 5.5 22h13c1.381 0 2.5-1.119 2.5-2.5V9.679l1.318.824 1.06-1.696L12 1.696zM12 16.5c-1.933 0-3.5-1.567-3.5-3.5s1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5-1.567 3.5-3.5 3.5z"})],-1),t("h3",{class:"text-2xl text-gray-900 mb-2"},"Chưa có bài đăng",-1),t("p",{class:"text-gray-600 m-0"},"Hãy là người đầu tiên đăng bài!",-1)])]))]))}}),ft={class:"min-h-screen bg-[#f0f2f5]"},gt={class:"flex justify-center pt-4"},pt={class:"w-full max-w-170 px-4 flex flex-col gap-3"},ht={class:"flex border-b border-[#e4e6eb] sticky top-14 bg-white z-10 shadow-sm rounded-t-lg"},mt={class:"mt-0"},_t=k({__name:"NewsfeedView",setup(e){const r=T("for_you"),l=c=>{r.value=c};return(c,o)=>(s(),a("div",ft,[i(S),t("div",gt,[t("div",pt,[t("div",ht,[t("button",{class:V(["flex-1 p-4 border-none bg-transparent text-[#65676b] font-semibold cursor-pointer relative transition-colors hover:bg-[#f0f2f5]",{"text-[#050505]":r.value==="for_you","after:content-[''] after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-[#1877f2] after:rounded-t":r.value==="for_you"}]),onClick:o[0]||(o[0]=u=>l("for_you"))}," Dành cho bạn ",2),t("button",{class:V(["flex-1 p-4 border-none bg-transparent text-[#65676b] font-semibold cursor-pointer relative transition-colors hover:bg-[#f0f2f5]",{"text-[#050505]":r.value==="following","after:content-[''] after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-[#1877f2] after:rounded-t":r.value==="following"}]),onClick:o[1]||(o[1]=u=>l("following"))}," Đang theo dõi ",2)]),t("div",mt,[i(j)]),o[2]||(o[2]=t("div",{class:"h-3 bg-transparent"},null,-1)),(s(),_(ut,{"feed-type":r.value,key:r.value},null,8,["feed-type"])),o[3]||(o[3]=t("div",{class:"h-6"},null,-1))])])]))}});export{_t as default};
